name: Test GKE Auth Plugin Installation
          
on:
  workflow_dispatch:   
          
jobs:
  test-install:
    runs-on: ubuntu-latest
          
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3
          
      - name: Install dependencies and GKE auth plugin (CORREGIDO)
        run: |
          sudo apt-get update
          
          # 1. Instala el CLI de Google Cloud usando el nombre de paquete correcto
          sudo apt-get install -y openssl kubectl curl **google-cloud-cli**
          
          # 2. Instala el plugin de GKE como un componente de gcloud (el método correcto)
          **gcloud components install gke-gcloud-auth-plugin**
          
          echo "export USE_GKE_GCLOUD_AUTH_PLUGIN=True" >> $GITHUB_ENV
          
      - name: Verify installations
        run: |
          echo "Checking versions..."
          kubectl version --client
          gcloud version
          
          # Verifica la existencia del binario del plugin
          if command -v gke-gcloud-auth-plugin >/dev/null 2>&1; then
            echo "✅ gke-gcloud-auth-plugin is installed!"
          else
            echo "❌ gke-gcloud-auth-plugin is NOT installed!"
            exit 1
          fi
