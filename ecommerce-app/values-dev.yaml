# Configuraciones globales (compartidas por todos los servicios)
global:
  namespace: dev
  pullPolicy: Always
  springProfilesActive: "dev"  # SPRING_PROFILES_ACTIVE=dev de Compose
  zipkinBaseUrl: "http://zipkin:9411"  # SPRING_ZIPKIN_BASE-URL
  eurekaRegion: "default"
  eurekaAvailabilityZones: "myzone"
  eurekaServiceUrlMyzone: "http://service-discovery:8761/eureka"  # EUREKA_CLIENT_SERVICEURL_MYZONE
  eurekaServiceUrlDefaultZone: "http://service-discovery:8761/eureka/"  # EUREKA_CLIENT_SERVICEURL_DEFAULTZONE
  configServerUrl: "http://cloud-config:9296/"  # SPRING_CONFIG_IMPORT

# Servicios Core (de tu primer Compose)
zipkin:
  enabled: true  # Agregado para control en Helm
  image:
    repository: "openzipkin/zipkin"  # Imagen fija de Compose
    tag: "latest"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 9411  # Puerto de Compose
  env: []  # Zipkin no tiene env extra en Compose

service-discovery:
  enabled: true
  image:
    repository: "selimhorri/service-discovery-ecommerce-boot"
    tag: "0.1.0"  # Tag inicial; sobrescrito por pipeline a TAG
  replicaCount: 1
  resources:
    requests:
      memory: "1024Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8761
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


cloud-config:
  enabled: true
  image:
    repository: "juaca2004/cloud-config"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "200m"
    limits:
      memory: "2Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 9296
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60

# Servicios Dependientes
api-gateway:
  image:
    repository: "selimhorri/api-gateway-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 2  # Más réplicas para testing en dev
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8080
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


proxy-client:
  image:
    repository: "selimhorri/proxy-client-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8900
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
order-service:
  image:
    repository: "selimhorri/order-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "200m"
    limits:
      memory: "2Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8300
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
payment-service:
  image:
    repository: "selimhorri/payment-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "200m"
    limits:
      memory: "2Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8400
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
product-service:
  image:
    repository: "selimhorri/product-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "200m"
    limits:
      memory: "2Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8500
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
shipping-service:
  image:
    repository: "selimhorri/shipping-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8600
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


user-service:
  image:
    repository: "selimhorri/user-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8700
  persistence:
    enabled: true  # Si usa DB, agrega PVC
    storageClass: "standard"
    size: "5Gi"
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60

favourite-service:
  image:
    repository: "selimhorri/favourite-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8800
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60

# Configuración de Ingress (para api-gateway, expuesto externamente)
ingress:
  enabled: true
  className: "nginx"
  hosts:
    - host: api-gateway.dev.example.com  # Cambia a tu dominio real (e.g., localhost para Minikube)
      paths:
        - path: /
          pathType: Prefix
  tls:  # Opcional en dev; habilita para HTTPS
    - secretName: api-gateway-tls
      hosts:
        - api-gateway.dev.example.com


# Monitoreo (opcional en dev)
prometheus:
  enabled: true
  serviceMonitor:
    enabled: true

# Autoscaling (ligero en dev)
hpa:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 70



# ============================================
# SECRETS CONFIGURATION
# ============================================
secrets:
  # Database credentials
  database:
    username: "ecommerce_user"
    password: "ecommerce_pass123"
  
  # JWT configuration
  jwt:
    secretKey: "mySecretKey123ForJwtTokenSigningAndValidation"
    expiration: "86400000"  # 24 hours in milliseconds
    refreshExpiration: "604800000"  # 7 days in milliseconds
  
  # External APIs
  externalApis:
    # Payment gateway (Stripe/PayPal mock)
    paymentApiKey: "sk_test_payment_api_key_123456789"
    paymentApiSecret: "payment_secret_abc123xyz"
    
    # Shipping provider (FedEx/UPS mock)
    shippingApiKey: "ship_api_key_987654321"
    shippingApiSecret: "shipping_secret_xyz789abc"
    
    # Email service (SMTP)
    emailUsername: "noreply@ecommerce-app.com"
    emailPassword: "email_password_secure123"

# ============================================
# PERSISTENCE CONFIGURATION
# ============================================
persistence:
  enabled: true
  storageClassName: "ecommerce-storage"
  
  # User Service Database
  userDb:
    size: "5Gi"
  
  # Product Service Database
  productDb:
    size: "10Gi"  # Más grande porque puede tener muchos productos
  
  # Order Service Database
  orderDb:
    size: "10Gi"  # Histórico de órdenes crece rápido
  
  # Payment Service Database
  paymentDb:
    size: "5Gi"
  
  # Shipping Service Database
  shippingDb:
    size: "5Gi"
  
  # Favourite Service Database
  favouriteDb:
    size: "3Gi"  # Menos datos
