# Configuraciones globales (compartidas por todos los servicios)
global:
  namespace: dev
  pullPolicy: Always
  springProfilesActive: "dev"  # SPRING_PROFILES_ACTIVE=dev de Compose
  zipkinBaseUrl: "http://zipkin:9411"  # SPRING_ZIPKIN_BASE-URL
  eurekaRegion: "default"
  eurekaAvailabilityZones: "myzone"
  eurekaServiceUrlMyzone: "http://service-discovery:8761/eureka"  # EUREKA_CLIENT_SERVICEURL_MYZONE
  eurekaServiceUrlDefaultZone: "http://service-discovery:8761/eureka/"  # EUREKA_CLIENT_SERVICEURL_DEFAULTZONE
  configServerUrl: "http://cloud-config:9296/"  # SPRING_CONFIG_IMPORT

# Servicios Core (de tu primer Compose)
zipkin:
  enabled: true  # Agregado para control en Helm
  image:
    repository: "openzipkin/zipkin"  # Imagen fija de Compose
    tag: "latest"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 9411  # Puerto de Compose
  env: []  # Zipkin no tiene env extra en Compose

service-discovery:
  enabled: true
  image:
    repository: "selimhorri/service-discovery-ecommerce-boot"
    tag: "0.1.0"  # Tag inicial; sobrescrito por pipeline a TAG
  replicaCount: 1
  resources:
    requests:
      memory: "512Mi"
      cpu: "100m"
    limits:
      memory: "768Mi"
      cpu: "300m"
  service:
    type: ClusterIP
    port: 8761
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60


cloud-config:
  enabled: true
  image:
    repository: "selimhorri/cloud-config-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "512Mi"
      cpu: "100m"
    limits:
      memory: "768Mi"
      cpu: "300m"
  service:
    type: ClusterIP
    port: 9296
  hpa:
    minReplicas: 1
    maxReplicas: 2
    cpuUtilization: 60

# Servicios Dependientes
api-gateway:
  image:
    repository: "selimhorri/api-gateway-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 2  # Más réplicas para testing en dev
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "500m"
  service:
    type: ClusterIP
    port: 8080


proxy-client:
  image:
    repository: "selimhorri/proxy-client-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8900


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
order-service:
  image:
    repository: "selimhorri/order-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8300


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
payment-service:
  image:
    repository: "selimhorri/payment-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8400


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
product-service:
  image:
    repository: "selimhorri/product-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8500


# Repite para los demás servicios dependientes (order-service, payment-service, etc.)
shipping-service:
  image:
    repository: "selimhorri/shipping-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8600


user-service:
  image:
    repository: "selimhorri/user-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8700
  persistence:
    enabled: true  # Si usa DB, agrega PVC
    storageClass: "standard"
    size: "5Gi"

favourite-service:
  image:
    repository: "selimhorri/favourite-service-ecommerce-boot"
    tag: "0.1.0"
  replicaCount: 1
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "200m"
  service:
    type: ClusterIP
    port: 8800

# Configuración de Ingress (para api-gateway, expuesto externamente)
ingress:
  enabled: true
  className: "nginx"
  hosts:
    - host: api-gateway.dev.example.com  # Cambia a tu dominio real (e.g., localhost para Minikube)
      paths:
        - path: /
          pathType: Prefix
  tls:  # Opcional en dev; habilita para HTTPS
    - secretName: api-gateway-tls
      hosts:
        - api-gateway.dev.example.com

# Monitoreo (opcional en dev)
prometheus:
  enabled: true
  serviceMonitor:
    enabled: true

# Autoscaling (ligero en dev)
hpa:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 70